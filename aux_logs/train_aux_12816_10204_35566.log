/home/soyoung/latent_ode1/train_aux.py
train_aux.py --niters 100 -n 8000 -l 20 --latent-ode --z0-encoder rnn --dataset physionet --rec-dims 40 --rec-layers 3 --gen-layers 3 --units 50 --gru-units 50 --quantization 0.016 --classif --step_size 0.03 --alpha 0.3 --m 10 --load_aux 12816_10204 --gpu 1
Experiment 12816_10204_35566
############### TOTAL ###############
TN, FP, FN, TP | Dopri 1625, 457, 44, 274
TN, FP, FN, TP | Euler 1626, 456, 69, 249
TN, FP, FN, TP | RK4 1616, 466, 75, 243
Classification AUC : Dopri 0.7613 | Euler 0.7596 | RK4 0.7596
NFE (average): Dopri 38.0 | Euler 34.0 | RK4 136.0
Elapsed time (average): Dopri 0.29361135959625245 | Euler 0.13400161862373353 | RK4 0.1631131052970886
----- Test Iter 0 | Test loss (one batch): 2.907428741455078
Cost(alpha 0.3) for Dopri integrator (one batch): 291.03509521484375
Cost(alpha 0.3) for Euler integrator (one batch): 286.7349548339844
Cost(alpha 0.3) for RK4 integrator (one batch): 357.72857666015625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([229.4340, 231.8971, 233.6342], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7777777777777778
----- Test Iter 1 | Test loss (one batch): 1.8147881031036377
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([218.3157, 220.4302, 222.3886], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.0
----- Test Iter 2 | Test loss (one batch): 1.69271719455719
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([185.6821, 186.7458, 188.8309], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.0
----- Test Iter 3 | Test loss (one batch): 2.402467966079712
Cost(alpha 0.3) for Dopri integrator (one batch): 234.8597412109375
Cost(alpha 0.3) for Euler integrator (one batch): 244.01699829101562
Cost(alpha 0.3) for RK4 integrator (one batch): 307.0205993652344
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([213.8973, 215.2213, 217.5825], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9197530864197531
----- Test Iter 4 | Test loss (one batch): 4.758208274841309
Cost(alpha 0.3) for Dopri integrator (one batch): 466.5832824707031
Cost(alpha 0.3) for Euler integrator (one batch): 471.84613037109375
Cost(alpha 0.3) for RK4 integrator (one batch): 498.58404541015625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([248.0660, 250.3208, 252.6407], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5061728395061729
----- Test Iter 5 | Test loss (one batch): 3.075779676437378
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 258.2563171386719
Cost(alpha 0.3) for RK4 integrator (one batch): 335.1916809082031
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([249.1527, 252.4604, 254.2204], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7916666666666667
----- Test Iter 6 | Test loss (one batch): 4.625394344329834
Cost(alpha 0.3) for Dopri integrator (one batch): 431.4736022949219
Cost(alpha 0.3) for Euler integrator (one batch): 436.2478332519531
Cost(alpha 0.3) for RK4 integrator (one batch): 464.7787170410156
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([225.0408, 227.1111, 229.1926], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5173611111111112
----- Test Iter 7 | Test loss (one batch): 3.74572491645813
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 357.72857666015625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([188.2794, 189.5172, 191.6296], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.8174603174603174
----- Test Iter 8 | Test loss (one batch): 2.2611494064331055
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 301.3863830566406
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([219.5909, 221.4104, 223.4696], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9427083333333334
----- Test Iter 9 | Test loss (one batch): 1.9735851287841797
Cost(alpha 0.3) for Dopri integrator (one batch): 213.79396057128906
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([209.0052, 211.7083, 213.1111], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9537037037037037
----- Test Iter 10 | Test loss (one batch): 3.167414903640747
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 251.13665771484375
Cost(alpha 0.3) for RK4 integrator (one batch): 323.92327880859375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([221.9631, 224.3601, 226.1790], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7342047930283224
----- Test Iter 11 | Test loss (one batch): 2.066964864730835
Cost(alpha 0.3) for Dopri integrator (one batch): 241.8816680908203
Cost(alpha 0.3) for Euler integrator (one batch): 244.01698303222656
Cost(alpha 0.3) for RK4 integrator (one batch): 318.2890319824219
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([239.6397, 242.3408, 244.3307], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9197530864197532
----- Test Iter 12 | Test loss (one batch): 1.6123454570770264
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 201.2990264892578
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([202.3646, 204.6140, 206.5479], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9473684210526316
----- Test Iter 13 | Test loss (one batch): 4.322743892669678
Cost(alpha 0.3) for Dopri integrator (one batch): 431.4735412597656
Cost(alpha 0.3) for Euler integrator (one batch): 414.88885498046875
Cost(alpha 0.3) for RK4 integrator (one batch): 464.7787170410156
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([223.4017, 225.9151, 227.7092], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.391812865497076
----- Test Iter 14 | Test loss (one batch): 3.489295721054077
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 335.19171142578125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([227.4060, 228.7942, 231.3072], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6844444444444444
----- Test Iter 15 | Test loss (one batch): 1.5979411602020264
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 273.21527099609375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([210.0276, 212.1167, 214.2015], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 1.0
----- Test Iter 16 | Test loss (one batch): 3.6104156970977783
Cost(alpha 0.3) for Dopri integrator (one batch): 298.0570373535156
Cost(alpha 0.3) for Euler integrator (one batch): 300.9742736816406
Cost(alpha 0.3) for RK4 integrator (one batch): 374.6312255859375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([208.2061, 210.3255, 212.0728], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8055555555555555
----- Test Iter 17 | Test loss (one batch): 3.83284854888916
Cost(alpha 0.3) for Dopri integrator (one batch): 403.3858642578125
Cost(alpha 0.3) for Euler integrator (one batch): 386.4101867675781
Cost(alpha 0.3) for RK4 integrator (one batch): 436.6076354980469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([248.8665, 251.5524, 253.5171], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.5272331154684096
----- Test Iter 18 | Test loss (one batch): 2.9125285148620605
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([237.3419, 239.9962, 242.0270], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.1234567901234568
----- Test Iter 19 | Test loss (one batch): 1.77243971824646
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 179.94004821777344
Cost(alpha 0.3) for RK4 integrator (one batch): 284.4837341308594
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([219.5769, 222.1205, 223.7319], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9649122807017545
----- Test Iter 20 | Test loss (one batch): 2.2339696884155273
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 301.3863830566406
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([216.7097, 218.8886, 220.7011], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.8947368421052632
----- Test Iter 21 | Test loss (one batch): 1.861547589302063
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([221.2326, 223.3496, 225.5369], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.0
----- Test Iter 22 | Test loss (one batch): 2.6710946559906006
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([203.1429, 205.7533, 207.2715], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.7962962962962963
----- Test Iter 23 | Test loss (one batch): 2.142705202102661
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([237.0469, 240.0317, 241.5736], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9166666666666666
----- Test Iter 24 | Test loss (one batch): 3.6049346923828125
Cost(alpha 0.3) for Dopri integrator (one batch): 333.1666259765625
Cost(alpha 0.3) for Euler integrator (one batch): 343.6922607421875
Cost(alpha 0.3) for RK4 integrator (one batch): 397.1680908203125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([225.5976, 227.4162, 229.6077], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6805555555555557
----- Test Iter 25 | Test loss (one batch): 2.162482261657715
Cost(alpha 0.3) for Dopri integrator (one batch): 255.925537109375
Cost(alpha 0.3) for Euler integrator (one batch): 251.1366424560547
Cost(alpha 0.3) for RK4 integrator (one batch): 335.1916809082031
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([228.4596, 230.9572, 232.9580], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.845679012345679
----- Test Iter 26 | Test loss (one batch): 2.5577030181884766
Cost(alpha 0.3) for Dopri integrator (one batch): 298.0569763183594
Cost(alpha 0.3) for Euler integrator (one batch): 300.9742736816406
Cost(alpha 0.3) for RK4 integrator (one batch): 368.99700927734375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([237.6404, 240.3480, 242.1857], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8714596949891068
----- Test Iter 27 | Test loss (one batch): 1.5807859897613525
Cost(alpha 0.3) for Dopri integrator (one batch): 185.7062530517578
Cost(alpha 0.3) for Euler integrator (one batch): 194.1793670654297
Cost(alpha 0.3) for RK4 integrator (one batch): 267.5810546875
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([195.9645, 198.5721, 199.8605], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9883040935672514
----- Test Iter 28 | Test loss (one batch): 2.1501119136810303
Cost(alpha 0.3) for Dopri integrator (one batch): 192.72817993164062
Cost(alpha 0.3) for Euler integrator (one batch): 194.1793670654297
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([194.2093, 195.5420, 197.5952], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9861111111111112
----- Test Iter 29 | Test loss (one batch): 2.7654380798339844
Cost(alpha 0.3) for Dopri integrator (one batch): 269.9693908691406
Cost(alpha 0.3) for Euler integrator (one batch): 279.6153259277344
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([198.6903, 200.1955, 202.2868], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8061002178649237
----- Test Iter 30 | Test loss (one batch): 2.6077115535736084
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 286.7349548339844
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([249.6009, 252.1452, 254.2973], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8003472222222222
----- Test Iter 31 | Test loss (one batch): 2.5568578243255615
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([238.4945, 241.1372, 243.1063], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9417989417989419
----- Test Iter 32 | Test loss (one batch): 3.474669933319092
Cost(alpha 0.3) for Dopri integrator (one batch): 319.1227722167969
Cost(alpha 0.3) for Euler integrator (one batch): 336.5726013183594
Cost(alpha 0.3) for RK4 integrator (one batch): 391.53387451171875
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([246.8611, 249.7451, 251.6019], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5138888888888888
----- Test Iter 33 | Test loss (one batch): 2.162230968475342
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 208.41868591308594
Cost(alpha 0.3) for RK4 integrator (one batch): 284.4837341308594
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([191.7007, 194.2733, 195.5446], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8784722222222222
----- Test Iter 34 | Test loss (one batch): 2.9131665229797363
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 272.4956359863281
Cost(alpha 0.3) for RK4 integrator (one batch): 335.19171142578125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([239.4040, 241.8491, 243.9872], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8993055555555556
----- Test Iter 35 | Test loss (one batch): 3.642493724822998
Cost(alpha 0.3) for Dopri integrator (one batch): 340.18853759765625
Cost(alpha 0.3) for Euler integrator (one batch): 336.5726013183594
Cost(alpha 0.3) for RK4 integrator (one batch): 391.53387451171875
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([202.9193, 204.7140, 206.6961], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.69281045751634
----- Test Iter 36 | Test loss (one batch): 2.918975591659546
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([269.7358, 272.5484, 274.9179], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.6361655773420478
----- Test Iter 37 | Test loss (one batch): 2.941145420074463
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 265.3759765625
Cost(alpha 0.3) for RK4 integrator (one batch): 329.5574645996094
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([242.8884, 245.4170, 247.4335], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6197916666666666
----- Test Iter 38 | Test loss (one batch): 3.0765717029571533
Cost(alpha 0.3) for Dopri integrator (one batch): 276.9912414550781
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([245.3950, 247.8021, 249.8629], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.7719298245614035
----- Test Iter 39 | Test loss (one batch): 4.297400951385498
Cost(alpha 0.3) for Dopri integrator (one batch): 396.36395263671875
Cost(alpha 0.3) for Euler integrator (one batch): 386.41021728515625
Cost(alpha 0.3) for RK4 integrator (one batch): 442.2418212890625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([221.4809, 223.0658, 225.4932], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.6432748538011696
----- Total Test Batches
Aux Net Accuracy: 0.525
AUC of the choices 0.7127 | Choice of Dopri5 40 | Euler 0 | RK4 0
TN, FP, FN, TP | AuxNet 1625, 457, 44, 274
Aux Net Runtime: 1601629325.2539
