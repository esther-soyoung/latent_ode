/home/soyoung/latent_ode1/train_aux.py
train_aux.py --niters 100 -n 8000 -l 20 --latent-ode --z0-encoder rnn --dataset physionet --rec-dims 40 --rec-layers 3 --gen-layers 3 --units 50 --gru-units 50 --quantization 0.016 --classif --load_aux 12816_4730 --step_size 0.03 --alpha 0.3 --m 10 --gpu 1
Experiment 12816_4730_76346
############### TOTAL ###############
TN, FP, FN, TP | Dopri 1625, 457, 44, 274
TN, FP, FN, TP | Euler 1626, 456, 69, 249
TN, FP, FN, TP | RK4 1616, 466, 75, 243
Classification AUC : Dopri 0.7613 | Euler 0.7596 | RK4 0.7596
NFE (average): Dopri 38.0 | Euler 34.0 | RK4 136.0
Elapsed time (average): Dopri 0.29063667058944703 | Euler 0.133958101272583 | RK4 0.16256511807441712
----- Test Iter 0 | Test loss (one batch): 2.5938844680786133
Cost(alpha 0.3) for Dopri integrator (one batch): 291.03509521484375
Cost(alpha 0.3) for Euler integrator (one batch): 286.7349548339844
Cost(alpha 0.3) for RK4 integrator (one batch): 357.72857666015625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([303.0161, 303.6666, 365.7929], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7777777777777778
----- Test Iter 1 | Test loss (one batch): 2.222520351409912
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([293.7953, 293.8480, 355.7294], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.0
----- Test Iter 2 | Test loss (one batch): 1.8434646129608154
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): euler | Predicted Cost: tensor([270.5063, 269.3525, 330.3605], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.0
----- Test Iter 3 | Test loss (one batch): 2.2886624336242676
Cost(alpha 0.3) for Dopri integrator (one batch): 234.8597412109375
Cost(alpha 0.3) for Euler integrator (one batch): 244.01699829101562
Cost(alpha 0.3) for RK4 integrator (one batch): 307.0205993652344
Choice of integrator (one batch): euler | Predicted Cost: tensor([288.5274, 288.2637, 349.9853], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.8981481481481481
----- Test Iter 4 | Test loss (one batch): 3.6876747608184814
Cost(alpha 0.3) for Dopri integrator (one batch): 466.5832824707031
Cost(alpha 0.3) for Euler integrator (one batch): 471.84613037109375
Cost(alpha 0.3) for RK4 integrator (one batch): 498.58404541015625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([313.7506, 314.8336, 377.4752], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5061728395061729
----- Test Iter 5 | Test loss (one batch): 2.928269147872925
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 258.2563171386719
Cost(alpha 0.3) for RK4 integrator (one batch): 335.1916809082031
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([318.9659, 320.3637, 383.2078], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7916666666666667
----- Test Iter 6 | Test loss (one batch): 3.57540225982666
Cost(alpha 0.3) for Dopri integrator (one batch): 431.4736022949219
Cost(alpha 0.3) for Euler integrator (one batch): 436.2478332519531
Cost(alpha 0.3) for RK4 integrator (one batch): 464.7787170410156
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([299.3812, 299.7392, 361.8240], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5173611111111112
----- Test Iter 7 | Test loss (one batch): 2.977804660797119
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 357.72857666015625
Choice of integrator (one batch): euler | Predicted Cost: tensor([272.5946, 271.4497, 332.7125], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8148148148148149
----- Test Iter 8 | Test loss (one batch): 2.2743723392486572
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 301.3863830566406
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([294.5782, 294.6081, 356.6190], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9427083333333334
----- Test Iter 9 | Test loss (one batch): 2.1121327877044678
Cost(alpha 0.3) for Dopri integrator (one batch): 213.79396057128906
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([291.7228, 291.7949, 353.4457], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9537037037037037
----- Test Iter 10 | Test loss (one batch): 2.8459103107452393
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 251.13665771484375
Cost(alpha 0.3) for RK4 integrator (one batch): 323.92327880859375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([297.3943, 297.6626, 359.6900], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7342047930283224
----- Test Iter 11 | Test loss (one batch): 2.283460855484009
Cost(alpha 0.3) for Dopri integrator (one batch): 241.8816680908203
Cost(alpha 0.3) for Euler integrator (one batch): 244.01698303222656
Cost(alpha 0.3) for RK4 integrator (one batch): 318.2890319824219
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([310.5114, 311.2967, 373.9997], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9197530864197532
----- Test Iter 12 | Test loss (one batch): 1.8752539157867432
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 201.2990264892578
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): euler | Predicted Cost: tensor([285.0656, 284.4706, 346.4068], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9415204678362573
----- Test Iter 13 | Test loss (one batch): 3.2671103477478027
Cost(alpha 0.3) for Dopri integrator (one batch): 431.4735412597656
Cost(alpha 0.3) for Euler integrator (one batch): 414.88885498046875
Cost(alpha 0.3) for RK4 integrator (one batch): 464.7787170410156
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([299.5255, 299.8099, 362.0146], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.391812865497076
----- Test Iter 14 | Test loss (one batch): 3.087153673171997
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 335.19171142578125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([298.3224, 298.6203, 360.6423], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6844444444444444
----- Test Iter 15 | Test loss (one batch): 2.044186592102051
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 273.21527099609375
Choice of integrator (one batch): euler | Predicted Cost: tensor([289.8907, 289.5352, 351.6206], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 1.0
----- Test Iter 16 | Test loss (one batch): 2.9363503456115723
Cost(alpha 0.3) for Dopri integrator (one batch): 298.0570373535156
Cost(alpha 0.3) for Euler integrator (one batch): 300.9742736816406
Cost(alpha 0.3) for RK4 integrator (one batch): 374.6312255859375
Choice of integrator (one batch): euler | Predicted Cost: tensor([287.8474, 287.6534, 349.3212], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.8246527777777778
----- Test Iter 17 | Test loss (one batch): 3.074263334274292
Cost(alpha 0.3) for Dopri integrator (one batch): 403.3858642578125
Cost(alpha 0.3) for Euler integrator (one batch): 386.4101867675781
Cost(alpha 0.3) for RK4 integrator (one batch): 436.6076354980469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([315.2635, 316.4882, 379.1516], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.5272331154684096
----- Test Iter 18 | Test loss (one batch): 2.9170005321502686
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([308.8325, 309.5455, 372.1975], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.1234567901234568
----- Test Iter 19 | Test loss (one batch): 2.1975796222686768
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 179.94004821777344
Cost(alpha 0.3) for RK4 integrator (one batch): 284.4837341308594
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([297.3258, 297.6401, 359.5895], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9649122807017545
----- Test Iter 20 | Test loss (one batch): 2.256129741668701
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 301.3863830566406
Choice of integrator (one batch): euler | Predicted Cost: tensor([292.5414, 292.4479, 354.3755], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9064327485380117
----- Test Iter 21 | Test loss (one batch): 2.27046275138855
Cost(alpha 0.3) for Dopri integrator (one batch): 178.684326171875
Cost(alpha 0.3) for Euler integrator (one batch): 172.8203887939453
Cost(alpha 0.3) for RK4 integrator (one batch): 261.94683837890625
Choice of integrator (one batch): euler | Predicted Cost: tensor([297.3877, 297.3454, 359.8129], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.0
----- Test Iter 22 | Test loss (one batch): 2.2419021129608154
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): euler | Predicted Cost: tensor([288.2958, 288.0356, 349.8048], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7654320987654322
----- Test Iter 23 | Test loss (one batch): 2.366816997528076
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53834533691406
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([309.0334, 310.0620, 372.3061], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9166666666666666
----- Test Iter 24 | Test loss (one batch): 2.9187700748443604
Cost(alpha 0.3) for Dopri integrator (one batch): 333.1666259765625
Cost(alpha 0.3) for Euler integrator (one batch): 343.6922607421875
Cost(alpha 0.3) for RK4 integrator (one batch): 397.1680908203125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([298.6134, 299.0021, 360.9159], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6805555555555557
----- Test Iter 25 | Test loss (one batch): 2.0990824699401855
Cost(alpha 0.3) for Dopri integrator (one batch): 255.925537109375
Cost(alpha 0.3) for Euler integrator (one batch): 251.1366424560547
Cost(alpha 0.3) for RK4 integrator (one batch): 335.1916809082031
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([302.1406, 302.5362, 364.9456], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.845679012345679
----- Test Iter 26 | Test loss (one batch): 2.271833896636963
Cost(alpha 0.3) for Dopri integrator (one batch): 298.0569763183594
Cost(alpha 0.3) for Euler integrator (one batch): 300.9742736816406
Cost(alpha 0.3) for RK4 integrator (one batch): 368.99700927734375
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([309.2447, 310.2389, 372.5576], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8714596949891068
----- Test Iter 27 | Test loss (one batch): 1.883967399597168
Cost(alpha 0.3) for Dopri integrator (one batch): 185.7062530517578
Cost(alpha 0.3) for Euler integrator (one batch): 194.1793670654297
Cost(alpha 0.3) for RK4 integrator (one batch): 267.5810546875
Choice of integrator (one batch): euler | Predicted Cost: tensor([282.0850, 281.5904, 342.9716], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9883040935672515
----- Test Iter 28 | Test loss (one batch): 2.0991291999816895
Cost(alpha 0.3) for Dopri integrator (one batch): 192.72817993164062
Cost(alpha 0.3) for Euler integrator (one batch): 194.1793670654297
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): euler | Predicted Cost: tensor([277.3549, 276.5458, 337.9498], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.9791666666666666
----- Test Iter 29 | Test loss (one batch): 2.251986026763916
Cost(alpha 0.3) for Dopri integrator (one batch): 269.9693908691406
Cost(alpha 0.3) for Euler integrator (one batch): 279.6153259277344
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): euler | Predicted Cost: tensor([280.3207, 279.7140, 341.0509], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.7647058823529411
----- Test Iter 30 | Test loss (one batch): 2.488901138305664
Cost(alpha 0.3) for Dopri integrator (one batch): 284.0132141113281
Cost(alpha 0.3) for Euler integrator (one batch): 286.7349548339844
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([316.0508, 317.1964, 379.9846], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8003472222222222
----- Test Iter 31 | Test loss (one batch): 2.6696674823760986
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 290.1179504394531
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([309.7125, 310.5276, 373.1568], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.9417989417989419
----- Test Iter 32 | Test loss (one batch): 2.9590117931365967
Cost(alpha 0.3) for Dopri integrator (one batch): 319.1227722167969
Cost(alpha 0.3) for Euler integrator (one batch): 336.5726013183594
Cost(alpha 0.3) for RK4 integrator (one batch): 391.53387451171875
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([316.5718, 317.7818, 380.5359], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.5138888888888888
----- Test Iter 33 | Test loss (one batch): 2.1720190048217773
Cost(alpha 0.3) for Dopri integrator (one batch): 199.75010681152344
Cost(alpha 0.3) for Euler integrator (one batch): 208.41868591308594
Cost(alpha 0.3) for RK4 integrator (one batch): 284.4837341308594
Choice of integrator (one batch): euler | Predicted Cost: tensor([280.0330, 279.4757, 340.7665], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.8993055555555556
----- Test Iter 34 | Test loss (one batch): 2.6847012042999268
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 272.4956359863281
Cost(alpha 0.3) for RK4 integrator (one batch): 335.19171142578125
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([308.9208, 309.5887, 372.2300], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.8993055555555556
----- Test Iter 35 | Test loss (one batch): 2.8391940593719482
Cost(alpha 0.3) for Dopri integrator (one batch): 340.18853759765625
Cost(alpha 0.3) for Euler integrator (one batch): 336.5726013183594
Cost(alpha 0.3) for RK4 integrator (one batch): 391.53387451171875
Choice of integrator (one batch): euler | Predicted Cost: tensor([283.0707, 282.4937, 344.1523], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.690631808278867
----- Test Iter 36 | Test loss (one batch): 3.0839264392852783
Cost(alpha 0.3) for Dopri integrator (one batch): 220.81588745117188
Cost(alpha 0.3) for Euler integrator (one batch): 215.53836059570312
Cost(alpha 0.3) for RK4 integrator (one batch): 295.7521667480469
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([329.5867, 331.3201, 394.7585], device='cuda:1')
Auxiliary network predicted False
AUC of the choice (one batch): 0.6361655773420478
----- Test Iter 37 | Test loss (one batch): 2.7613673210144043
Cost(alpha 0.3) for Dopri integrator (one batch): 262.94744873046875
Cost(alpha 0.3) for Euler integrator (one batch): 265.3759765625
Cost(alpha 0.3) for RK4 integrator (one batch): 329.5574645996094
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([311.6832, 312.6181, 375.2600], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6197916666666666
----- Test Iter 38 | Test loss (one batch): 2.8101203441619873
Cost(alpha 0.3) for Dopri integrator (one batch): 276.9912414550781
Cost(alpha 0.3) for Euler integrator (one batch): 279.61529541015625
Cost(alpha 0.3) for RK4 integrator (one batch): 352.0943603515625
Choice of integrator (one batch): dopri5 | Predicted Cost: tensor([312.2442, 313.2560, 375.7510], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.7719298245614035
----- Test Iter 39 | Test loss (one batch): 3.3367748260498047
Cost(alpha 0.3) for Dopri integrator (one batch): 396.36395263671875
Cost(alpha 0.3) for Euler integrator (one batch): 386.41021728515625
Cost(alpha 0.3) for RK4 integrator (one batch): 442.2418212890625
Choice of integrator (one batch): euler | Predicted Cost: tensor([293.1387, 292.8871, 355.0409], device='cuda:1')
Auxiliary network predicted True
AUC of the choice (one batch): 0.6608187134502924
----- Total Test Batches
Aux Net Accuracy: 0.5
AUC of the choices 0.7117 | Choice of Dopri5 25 | Euler 15 | RK4 0
TN, FP, FN, TP | AuxNet 1624, 458, 56, 262
Aux Net Runtime: 1601622268.8153
